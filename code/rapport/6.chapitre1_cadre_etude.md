# CHAPITRE 1 - CADRE DE L'ÉTUDE

## 1.1 Présentation d'Allianz France

### Le groupe Allianz : un acteur mondial de l'assurance

Le groupe Allianz a été fondé en 1890 à Berlin et son siège social se trouve aujourd'hui à Munich. Avec plus de 130 ans d'existence, Allianz s'est imposé comme l'un des leaders mondiaux de l'assurance et de la gestion d'actifs. Le groupe est présent dans plus de 70 pays à travers le monde, couvrant l'ensemble des continents : Europe, Amérique du Nord, Europe centrale et orientale, et la région Asie-Pacifique. Cette implantation internationale permet au groupe de comprendre les enjeux locaux tout en bénéficiant d'une vision globale des marchés.

L'offre d'Allianz couvre l'ensemble des besoins assurantiels : assurances dommages (automobile, habitation, construction), assurances santé, prévoyance et assurances vie. Le groupe s'adresse aussi bien aux particuliers qu'aux professionnels, entreprises et collectivités. Au-delà de l'assurance, Allianz utilise son réseau d'agents pour proposer également des produits bancaires, diversifiant ainsi ses activités financières. Cet environnement de travail international favorise la collaboration entre les équipes aux quatre coins du monde et encourage le partage d'expertises.

### Allianz France : une histoire riche et un positionnement fort

L'histoire d'Allianz France est étroitement liée à celle des Assurances Générales de France (AGF), créées en 1818 par Martin d'André. En 1849, AGF signe un traité de réassurance avec la Phénix de Londres et devient rapidement l'une des meilleures compagnies d'assurance au monde. En 1968, une fusion entre la Générale et le Phénix donne naissance aux "AGF". Presque trente ans plus tard, en 1996, AGF est privatisée à hauteur de 51%, marquant un tournant dans son organisation. L'année suivante, en 1997, une nouvelle vague de consolidation débute : AGF fusionne avec Allianz France et PFA-Athéna Assurance, propulsant le groupe comme la troisième compagnie d'assurance en France.

En 2007, Allianz, qui détenait déjà 58% des actions, rachète l'intégralité des parts minoritaires d'AGF. AGF devient alors une filiale à 100% du groupe allemand. Deux ans plus tard, en 2009, la marque AGF disparaît définitivement au profit d'Allianz France, unifiant l'ensemble des activités sous une seule et même enseigne.

**[FIGURE 1.1 : Carte d'implantation du groupe Allianz dans le monde - Insérer ici]**

Aujourd'hui, Allianz France, dont le siège est situé à Paris, est un fournisseur majeur de services financiers spécialisé dans l'assurance et la gestion d'actifs. Avec près de 2 500 points de vente répartis sur le territoire, elle dispose du deuxième plus grand réseau français. L'entreprise emploie environ 11 000 collaborateurs et accompagne plus de 5 millions de clients partout en France. Son offre est particulièrement diversifiée et couvre tous les besoins de la vie quotidienne : assurance automobile, bateau, habitation, construction, santé, prévoyance, assurance vie, retraite, services bancaires et protection juridique.

Les résultats financiers du groupe témoignent de sa solidité. En 2019, Allianz France affichait un chiffre d'affaires compris entre 11 et 12 milliards d'euros, confirmant sa position de leader sur le marché français. Cette performance repose sur la qualité de ses services, son réseau étendu et la diversité de son portefeuille d'activités.

### Les principales filiales d'Allianz France

Allianz France s'appuie sur six filiales spécialisées, chacune intervenant dans un domaine d'expertise spécifique :

**Allianz France** constitue la filiale principale, portant l'activité d'assurance traditionnelle pour les particuliers et les entreprises sur le marché français.

**Allianz Global Corporate & Specialty** (AGCS) s'adresse à une clientèle d'entreprises et propose des solutions clés en main pour les grands risques industriels. AGCS couvre un large éventail de besoins : dommages aux biens, risques techniques, responsabilité civile, assurance maritime (marchandises, corps de navire, yachts), assurance aviation (aviation générale, aéroports, compagnies aériennes), aérospatiale, lignes financières et divertissement. La filiale offre également des services de gestion du risque, d'indemnisation et d'assurances internationales via Allianz Multinational.

**Allianz Global Investors** gère plusieurs milliards d'euros d'investissements et se positionne comme un acteur reconnu de la gestion d'actifs et de l'investissement socialement responsable. La filiale couvre l'ensemble du spectre des couples rendement-risque : actions, obligations, stratégies multi-actifs et investissements alternatifs. Elle dispose d'une expertise reconnue et d'un grand nombre de professionnels de l'investissement.

**Allianz Real Estate** (ARE) est l'un des leaders mondiaux en investissements immobiliers. En France, ARE gère notamment le patrimoine immobilier d'Allianz France. La filiale développe et met en œuvre des stratégies d'investissement pour le compte du groupe Allianz, en se concentrant sur des investissements directs et indirects à l'échelle mondiale, ainsi que sur des financements immobiliers en Europe et aux États-Unis.

**Allianz Global Assistance** est le leader mondial de l'assurance voyage et de l'assistance. La filiale propose des produits de protection voyage sur mesure, adaptés aux besoins spécifiques de chaque client. Elle garantit une qualité de service optimale et protège les voyageurs contre les conséquences d'événements imprévus, qu'il s'agisse d'annulations, de retards ou d'urgences médicales.

**Euler Hermes**, leader mondial de l'assurance-crédit et du recouvrement commercial, aide les entreprises à développer leurs activités en les protégeant contre le risque d'insolvabilité de leurs clients. Quel que soit le secteur d'activité, le pays d'origine ou la taille de l'entreprise concernée, Euler Hermes accompagne ses clients dans la sécurisation de leurs transactions commerciales.

Cette organisation en filiales spécialisées permet à Allianz France de couvrir l'ensemble des besoins assurantiels et financiers, tout en capitalisant sur des expertises métier pointues dans chaque domaine.

---

## 1.2 La direction P4D et le pôle Advanced Data & Climate

### La direction Pricing, Portfolio, Pilotage, Performance & Data (P4D)

Au sein de l'unité Assurances de Biens et de Responsabilités (ABR) d'Allianz France, la direction P4D joue un rôle central dans la définition de la stratégie tarifaire, le pilotage du portefeuille et la gestion des données. Comme son nom l'indique, P4D regroupe quatre dimensions essentielles : le Pricing (tarification), le Portfolio (gestion de portefeuille), le Pilotage (suivi des performances) et la Performance & Data (exploitation des données).

Cette direction structure ses activités autour de plusieurs pôles spécialisés, chacun dédié à un segment de marché ou à une expertise transverse. On y trouve notamment les pôles Pricing & Portfolio pour les différents marchés (Auto, IRD Particuliers, Pros, MidCorp), ainsi que deux pôles transverses : Business & Strategic Steering, et Advanced Data & Climate. C'est au sein de ce dernier qu'a été réalisée la mission présentée dans ce rapport.

**[FIGURE 1.2 : Organigramme de la direction P4D et du pôle Advanced Data & Climate]**

### Le pôle Advanced Data & Climate : missions et positionnement

Le pôle Advanced Data & Climate (ADC) occupe une position stratégique au sein de P4D. Il regroupe les expertises en gestion de données, modélisations actuarielles et expertises climatiques. Son rôle est de fournir des données fiables et structurées aux autres pôles de P4D, tout en développant des outils d'analyse avancés pour accompagner les décisions stratégiques de l'entreprise.

Le pôle ADC est organisé autour de trois grandes activités complémentaires :

**Data Management** constitue le cœur opérationnel du pôle. Cette équipe est responsable de la mise à disposition des datamarts, bases de données agrégées et structurées par marché (Construction, Auto, Habitation, Santé, Épargne), qui alimentent les analyses métier de l'ensemble de la direction P4D. Le data management assure la collecte, le nettoyage, la transformation et la mise à jour régulière de ces données. C'est au sein de cette équipe qu'a été réalisée la mission, au cœur du projet de migration SAS vers PySpark.

**Expertises Transverses** regroupe les compétences actuarielles et statistiques du pôle. Ces équipes développent des modélisations sophistiquées pour évaluer les risques, calculer les provisions techniques, optimiser les tarifs et anticiper les évolutions de portefeuille. Elles apportent un support méthodologique aux autres pôles de P4D et contribuent à la définition des stratégies d'assurance.

**Expertises Climatiques** constitue une spécificité du pôle ADC. Face aux enjeux croissants du changement climatique et de son impact sur les risques assurés (événements climatiques extrêmes, catastrophes naturelles, évolution des sinistres liés au climat), cette équipe développe des modèles prédictifs et des outils d'analyse pour anticiper ces risques et adapter les stratégies de souscription et de tarification.

Le positionnement transverse du pôle ADC lui permet d'interagir avec l'ensemble des autres pôles de P4D : il fournit les données nécessaires au pricing, au pilotage de portefeuille, et aux analyses de performance. Cette position centrale fait du pôle ADC un maillon essentiel dans la chaîne de valeur de la direction P4D.

---

## 1.3 L'équipe de Data Management : cadre d'accueil de la mission

### Rôle et missions de l'équipe

La mission s'est déroulée au sein de l'équipe Data Management du pôle Advanced Data & Climate. Cette équipe a pour mission principale de gérer l'ensemble du cycle de vie des datamarts P&C (Property & Casualty), de leur conception à leur mise à disposition aux utilisateurs métier. Les datamarts sont des bases de données spécialisées par marché qui agrègent et structurent les données de production (polices, sinistres, primes, capitaux) pour faciliter les analyses actuarielles et stratégiques.

L'équipe assure plusieurs fonctions clés :

**La mise à disposition des datamarts** constitue l'activité principale. L'équipe gère actuellement cinq datamarts correspondant aux cinq marchés P&C d'Allianz France : Construction (marché six), Auto, Habitation, Santé et Épargne. Ces datamarts sont mis à jour mensuellement ou trimestriellement selon les besoins métier. Ils alimentent les analyses de l'ensemble de la direction P4D : calculs de provisions, études tarifaires, suivi de portefeuille, reporting réglementaire.

**Le développement de projets transverses** permet à l'équipe de répondre aux besoins spécifiques des différents pôles de P4D. Cela peut concerner la création de nouveaux indicateurs, l'évolution des méthodologies de calcul, ou encore l'intégration de nouvelles sources de données ou autres applications de visualisation. L'équipe travaille en étroite collaboration avec les équipes métier pour comprendre leurs besoins et adapter les datamarts en conséquence.

**La modernisation de l'infrastructure data** représente un enjeu stratégique majeur. C'est dans ce cadre que s'inscrit le projet "SAS EXIST", dont fait partie la mission confiée. L'équipe pilote la migration progressive des datamarts de l'infrastructure SAS historique vers une architecture cloud moderne basée sur Azure et PySpark. Cette transition vise à améliorer les performances, réduire les coûts et renforcer la scalabilité du système.

### Positionnement et interactions

L'équipe Data Management occupe une position centrale dans l'écosystème P4D. Elle interagit quotidiennement avec les autres pôles pour comprendre leurs besoins en données et répondre aux demandes d'évolution des datamarts. Cette position d'interface entre les sources de données brutes et les utilisateurs finaux confère à l'équipe une vision globale des flux de données et des enjeux métier de l'assurance.

L'intégration dans cette équipe a permis de travailler sur un projet stratégique à fort enjeu : la migration du datamart Construction de SAS vers PySpark. Ce projet s'inscrit dans une démarche plus large de transformation digitale de l'infrastructure data d'Allianz France, et constituait le premier prototype de cette migration pour l'ensemble des datamarts P&C.

---

## 1.4 Contexte stratégique et enjeux de la migration

### Rôle central des datamarts dans l'analyse assurantielle

Les datamarts constituent un élément essentiel de l'infrastructure décisionnelle d'Allianz France. Ces bases de données spécialisées agrègent et structurent les données de production (polices, sinistres, primes, capitaux) pour les rendre exploitables par les équipes métier. Ils alimentent l'ensemble de la chaîne de valeur actuarielle et commerciale : calculs de provisions techniques, études tarifaires, analyses de rentabilité, pilotage du portefeuille, reporting réglementaire, et décisions stratégiques de souscription.

Chaque datamart correspond à un marché spécifique (Construction, Auto, Habitation, Santé, Épargne) et contient plusieurs années d'historique, permettant des analyses longitudinales et des comparaisons temporelles. La fiabilité et la disponibilité de ces datamarts sont donc critiques pour le bon fonctionnement de la direction P4D et, plus largement, pour la performance commerciale et financière d'Allianz France.

### Le projet "SAS EXIST" : une initiative stratégique de transformation

Actuellement, l'ensemble des datamarts P&C d'Allianz France fonctionne sur une infrastructure SAS historique, en place depuis plusieurs années. Cette infrastructure a longtemps été performante et a permis de répondre aux besoins métier. Cependant, elle présente aujourd'hui plusieurs limites structurelles qui freinent l'évolution de l'entreprise :

**Les coûts de licences SAS sont devenus prohibitifs.** SAS est une technologie propriétaire dont les licences annuelles représentent un investissement financier important. Ces coûts sont d'autant plus difficiles à justifier que des alternatives open source performantes existent désormais sur le marché.

**L'expertise SAS se raréfie sur le marché du travail.** Les nouvelles générations de data engineers et de data scientists sont formées principalement à Python, Spark et aux technologies cloud. Recruter et maintenir une équipe d'experts SAS devient de plus en plus difficile, créant un risque de dépendance vis-à-vis de quelques personnes clés et compliquant la transmission de connaissances.

**Les performances des serveurs SAS actuels sont limitées.** L'infrastructure repose sur des serveurs vieillissants qui ne bénéficient plus des dernières optimisations matérielles. Les temps de traitement sont longs, particulièrement pour les analyses sur plusieurs années ou pour les calculs complexes impliquant des jointures multiples.

**La scalabilité est contrainte.** L'architecture SAS monolithique ne permet pas d'augmenter facilement les capacités de calcul en fonction des besoins. Lorsque les volumes de données augmentent ou que des traitements exceptionnels sont nécessaires, il n'est pas possible d'allouer temporairement plus de ressources.

**La maintenance du code est complexe.** Le code SAS historique, développé sur plusieurs années par différentes personnes, contient de nombreuses macros imbriquées, des variables globales non documentées, et une logique métier parfois difficile à tracer. Cette complexité rend les évolutions coûteuses en temps et augmente le risque d'erreurs.

Face à ces constats, Allianz France a lancé en 2024 le projet "SAS EXIST" (SAS Exit Strategy), initiative stratégique visant à migrer progressivement l'ensemble des datamarts SAS vers une architecture moderne basée sur le cloud Azure et le framework PySpark. Ce projet s'inscrit dans une dynamique plus large de transformation digitale de l'entreprise et d'alignement sur les standards technologiques du groupe Allianz.

**[FIGURE 1.3 : Schéma "Pourquoi ce projet ?" - Limites SAS vs Objectifs PySpark]**

### Les enjeux de la migration vers Azure et PySpark

La migration vers PySpark et Azure Databricks répond à plusieurs enjeux stratégiques et opérationnels :

**Réduction significative des coûts opérationnels.** Le passage à des technologies open source (Python, Spark) permet d'éliminer les licences SAS propriétaires. Si l'utilisation d'Azure Databricks implique des coûts d'infrastructure cloud, ceux-ci sont plus prévisibles et modulables que les licences SAS, et l'élasticité du cloud permet d'optimiser les dépenses en allouant des ressources uniquement lorsque c'est nécessaire.

**Amélioration des performances grâce au calcul distribué.** PySpark, basé sur Apache Spark, permet de traiter les données en parallèle sur plusieurs nœuds de calcul. Cette architecture distribuée améliore drastiquement les temps de traitement, en particulier pour les opérations sur de gros volumes de données (jointures, agrégations, transformations complexes).

**Scalabilité et élasticité du cloud.** L'infrastructure Azure permet d'adapter dynamiquement les ressources de calcul en fonction des besoins. Pour des traitements ponctuels intensifs (clôtures annuelles, recalculs historiques), il est possible d'allouer temporairement des clusters plus puissants, puis de les libérer une fois le traitement terminé.

**Alignement avec la stratégie technologique du groupe Allianz.** Au niveau global, le groupe Allianz a adopté une stratégie de cloudification de ses infrastructures et de standardisation sur Azure et les technologies Spark. Migrer les datamarts français vers cette stack technologique permet de bénéficier des synergies groupe, du partage de bonnes pratiques, et de la mutualisation d'expertises entre les différentes entités nationales.

**Garantie de la parité fonctionnelle.** L'enjeu majeur de cette migration est de garantir que les résultats produits par les nouveaux pipelines Python sont strictement identiques aux résultats SAS actuels. Cette parité fonctionnelle est absolument critique : les datamarts alimentent des calculs réglementaires, des décisions de souscription et des stratégies commerciales. Le moindre écart pourrait avoir des conséquences financières et réglementaires importantes.

**Modernisation de l'architecture grâce au modèle médaillon.** Au-delà de la simple transposition du code SAS en Python, la migration est l'occasion de repenser l'architecture des pipelines de données. L'adoption d'une architecture médaillon (Bronze → Silver → Gold), standard de l'industrie, améliore la maintenabilité, la traçabilité et la qualité des données.

Cependant, un tel projet de migration comporte aussi des défis importants. Il faut maintenir les deux systèmes (SAS et PySpark) en parallèle pendant la phase de transition, former les équipes aux nouvelles technologies, documenter exhaustivement la logique métier pour éviter les pertes de connaissance, et valider rigoureusement la parité fonctionnelle avant de basculer en production.

---

## 1.5 Problématique et objectifs de la mission

### Problématique

Face aux enjeux décrits précédemment, la direction P4D d'Allianz France a décidé d'adopter une approche progressive pour la migration de ses datamarts. Plutôt que de migrer simultanément les cinq marchés, ce qui présenterait un risque opérationnel trop élevé, l'équipe a choisi de commencer par un marché pilote : le marché Construction.

Ce choix s'explique par plusieurs facteurs. Le datamart Construction présente une complexité modérée comparé à d'autres marchés comme l'Auto ou l'Habitation, tout en étant suffisamment riche pour tester l'ensemble des défis techniques de la migration. Il permet de valider la faisabilité de la démarche, d'identifier les points de blocage, et de construire une méthodologie reproductible pour les autres marchés.

La problématique centrale de la mission peut donc être formulée ainsi :

**Comment migrer le datamart Construction de SAS vers PySpark tout en garantissant la parité fonctionnelle stricte avec l'existant, en construisant une architecture moderne et évolutive, et en documentant exhaustivement la démarche pour servir de référence aux futures migrations ?**

Cette problématique comporte plusieurs dimensions :

**Dimension technique :** Comprendre la logique métier complexe encodée dans environ 15 000 lignes de code SAS réparties sur dix-neuf fichiers, identifier toutes les transformations et règles de gestion, et les transposer fidèlement en Python/PySpark.

**Dimension architecturale :** Concevoir une architecture cible moderne (médaillon Bronze/Silver/Gold) qui soit à la fois conforme aux standards de l'industrie, adaptée aux spécificités métier du marché Construction, et suffisamment générique pour être réutilisée sur les autres marchés.

**Dimension qualité :** Mettre en place une méthodologie de validation rigoureuse pour garantir que les résultats Python sont strictement identiques aux résultats SAS, en testant sur plusieurs périodes (visions) et en comparant l'ensemble des indicateurs clés.

**Dimension documentation :** Produire une documentation technique complète du code SAS existant (qui n'était pas documenté), du code Python développé, et de la méthodologie suivie, afin de faciliter la reprise du projet par d'autres équipes et de capitaliser les enseignements pour les prochaines migrations.

### Enjeux stratégiques pour Allianz France

Au-delà de la simple migration d'un datamart, cette mission constitue un jalon stratégique pour l'entreprise. Le succès de ce prototype conditionne la faisabilité et le calendrier de migration des quatre autres marchés P&C. Les enjeux sont multiples :

**Validation de la faisabilité technique.** Le projet doit démontrer qu'il est possible de migrer un datamart SAS complet vers PySpark en garantissant la parité fonctionnelle. Si ce premier prototype échoue ou révèle des blocages techniques insurmontables, c'est l'ensemble de la stratégie "SAS EXIST" qui devra être reconsidérée.

**Construction d'une méthodologie reproductible.** Les enseignements tirés de cette première migration (pièges techniques, bonnes pratiques, outils de validation) doivent être formalisés pour accélérer et sécuriser les migrations suivantes. L'objectif est de créer un "playbook" de migration qui pourra être appliqué aux autres marchés.

**Réduction progressive de la dépendance à SAS.** Chaque datamart migré réduit la surface d'utilisation de SAS et donc les coûts de licences associés. À terme, l'objectif est d'arrêter complètement les serveurs SAS et de réaliser les économies attendues.

**Montée en compétence de l'équipe.** La migration est aussi l'occasion de former les équipes Data Management aux technologies cloud modernes (PySpark, Azure, Databricks), de développer une expertise interne, et de réduire la dépendance à des compétences SAS de plus en plus rares.

### Objectifs de la mission

Pour répondre à cette problématique, la mission a été structurée autour de quatre objectifs principaux :

**1. Créer le premier prototype de migration opérationnel**

L'objectif principal est de livrer un prototype fonctionnel du datamart Construction en PySpark, capable de produire les mêmes résultats que le datamart SAS actuel. Ce prototype doit couvrir l'ensemble des trois pipelines du datamart : PTF Mouvements (mouvements de portefeuille), Capitaux (extraction et indexation des capitaux assurés), et Émissions (calcul des primes).

**2. Valider la faisabilité technique de la migration**

Il s'agit de démontrer que la migration est techniquement viable, que les défis rencontrés peuvent être résolus, et que les performances de l'architecture PySpark sont au moins équivalentes, voire supérieures, à celles de SAS. Cette validation passe par des tests sur plusieurs périodes (visions) et par la comparaison systématique des résultats Python et SAS.

**3. Documenter exhaustivement la méthodologie et les livrables**

La mission doit produire une documentation technique complète couvrant plusieurs aspects : analyse détaillée du code SAS existant, recensement exhaustif des règles métier et des sources de données, documentation du code Python développé, guide de validation et de tests. Cette documentation servira de référence pour les prochaines migrations et garantira la pérennité du projet.

**4. Établir les bases d'une architecture cible réutilisable**

L'architecture développée pour le marché Construction doit pouvoir servir de modèle pour les autres marchés. Il s'agit donc de concevoir une structure modulaire, avec des composants réutilisables (readers, helpers, transformers), une gestion de configuration externalisée, et des patterns de code clairs et reproductibles.

Ces quatre objectifs ont guidé l'ensemble du travail réalisé durant les six mois de la mission, structuré en cinq phases méthodologiques détaillées dans le chapitre trois.
